// HspppSample/UserApp.cpp
import hsppp;
using namespace hsppp;

// ユーザーのエントリーポイント
int hspMain() {
    // ═══════════════════════════════════════════════════════════
    // HSP互換の描画システム - redrawは省略可能！
    // ═══════════════════════════════════════════════════════════
    //
    // 【パターン1: redrawなしで描画（最もシンプル）】
    // デフォルトは描画モード1（即座に反映）なので、
    // redrawを一切使わずに描画命令だけで動作します。
    //
    // 【パターン2: redrawでちらつき防止】
    // redraw 0 → 描画命令群 → redraw 1 でちらつきを防止できます。
    //
    // ═══════════════════════════════════════════════════════════

    // ウィンドウ作成（省略可能）
    // screen命令を書かなくても、描画命令を呼ぶと自動的に
    // 640x480のデフォルトウィンドウが作成されます。
    screen(0, 800, 600, screen_normal, -1, -1, 0, 0, "HSPPP Sample Window");

    // ───────────────────────────────────────────────────────────
    // パターン1: redrawなしで描画（コメントアウトして試せます）
    // ───────────────────────────────────────────────────────────
    // color(255, 255, 255);
    // boxf();
    // color(0, 0, 0);
    // boxf(50, 50, 200, 150);
    // color(255, 0, 0);
    // pos(100, 200);
    // mes("redrawなしでも表示されます！");

    // ───────────────────────────────────────────────────────────
    // パターン2: redrawでちらつき防止（現在有効）
    // ───────────────────────────────────────────────────────────
    redraw(0);  // 描画モード0: 仮想画面のみ（ちらつき防止）

    // 背景を白で塗りつぶし
    color(255, 255, 255);
    boxf();

    // 黒い矩形を描画
    color(0, 0, 0);
    boxf(50, 50, 200, 150);

    // 赤いテキストを描画
    color(255, 0, 0);
    pos(100, 200);
    mes("Hello, HSPPP World!");

    // 青いテキストを描画
    color(0, 0, 255);
    pos(100, 250);
    mes("Direct2Dで描画しています");

    // 緑のテキストを描画
    color(0, 128, 0);
    pos(100, 300);
    mes("HSP互換API (C++20 Modules)");

    redraw(1);  // 描画モード1: 画面に反映

    // hspMainを抜けると、HSPのstop命令と同じ動作になる
    // ウィンドウは表示され続け、×ボタンで終了できる
    return 0;
}
